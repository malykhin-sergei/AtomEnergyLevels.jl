<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>AtomEnergyLevels.jl · AtomEnergyLevels</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">AtomEnergyLevels</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>AtomEnergyLevels.jl</a><ul class="internal"><li><a class="tocitem" href="#Theory"><span>Theory</span></a></li><li><a class="tocitem" href="#Functions-for-solving-Schrödinger-equation"><span>Functions for solving Schrödinger equation</span></a></li><li><a class="tocitem" href="#Kohn-Sham-equations"><span>Kohn-Sham equations</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>AtomEnergyLevels.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>AtomEnergyLevels.jl</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/malykhin-sergei/AtomEnergyLevels.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="AtomEnergyLevels.jl"><a class="docs-heading-anchor" href="#AtomEnergyLevels.jl">AtomEnergyLevels.jl</a><a id="AtomEnergyLevels.jl-1"></a><a class="docs-heading-anchor-permalink" href="#AtomEnergyLevels.jl" title="Permalink"></a></h1><p>Solve numerically</p><ol><li>1D <a href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation">Schrödinger equation</a> by the <a href="https://en.wikipedia.org/wiki/Collocation_method">spectral collocation (i.e., pseudospectral) method</a></li><li>Schrödinger equation for the <a href="https://en.wikipedia.org/wiki/Particle_in_a_spherically_symmetric_potential">particle in a spherically symmetric potential</a></li><li><a href="https://en.wikipedia.org/wiki/Kohn%E2%80%93Sham_equations">Kohn-Sham equation</a> for an atom using <a href="https://en.wikipedia.org/wiki/Local-density_approximation">local-density approximation (LDA)</a></li></ol><h2 id="Theory"><a class="docs-heading-anchor" href="#Theory">Theory</a><a id="Theory-1"></a><a class="docs-heading-anchor-permalink" href="#Theory" title="Permalink"></a></h2><h3 id="Change-of-variables"><a class="docs-heading-anchor" href="#Change-of-variables">Change of variables</a><a id="Change-of-variables-1"></a><a class="docs-heading-anchor-permalink" href="#Change-of-variables" title="Permalink"></a></h3><p>The dynamics of a particle in a spherically symmetric potential are governed by a Hamiltonian of the following form:</p><p class="math-container">\[-\frac{\hbar^{2}}{2\mu}\underset{\Delta R_{nl}}{\underbrace{\left[\frac{1}{r^{2}}\frac{\partial}{\partial r}\left(r^{2}\frac{\partial R_{nl}}{\partial r}\right)-\frac{l(l+1)}{r^{2}}R_{nl}(r)\right]}}+V(r)R_{nl}(r)=E_{nl}R_{nl}(r)\]</p><p>where <span>$\Delta$</span> - <a href="https://en.wikipedia.org/wiki/Laplace_operator">Laplace operator</a>, <span>$r$</span> - distance between the particle and a defined center point (nucleus), <span>$\mu$</span> - <a href="https://en.wikipedia.org/wiki/Reduced_mass">reduced mass</a>, <span>$R_{nl}(r)$</span> - radial part of a wavefunction, <span>$E_{nl}$</span> - eigenstate of a system (energy level). The eigenfunctions are</p><p class="math-container">\[\psi(r,\,\theta,\,\phi)=R_{nl}(r)\cdot Y_{lm}(\theta,\,\phi)\]</p><p>where <span>$Y_{lm}(\theta,\,\phi)$</span> - <a href="https://en.wikipedia.org/wiki/Spherical_harmonics">spherical harmonic.</a></p><p>The substitution</p><p class="math-container">\[R_{nl}(r)=\frac{1}{r}P_{nl}(r)\]</p><p>can be used to write the radial Schrödinger equation as:</p><p class="math-container">\[-\frac{\hbar^{2}}{2m}\left[\frac{\partial^{2}P_{nl}}{\partial r^{2}}-\frac{l(l+1)}{r^{2}}P_{nl}(r)\right]+V(r)P_{nl}(r)=E_{nl}P_{nl}(r)\]</p><p>Variable <span>$r$</span> and eigenfunction <span>$P_{nl}(r)$</span> can be changed to <span>$x$</span> and <span>$y_{nl}(x)$</span> for the convenience of numerical solution.</p><p class="math-container">\[\begin{aligned}
r &amp;= e^{x}\\
y_{nl}(x) &amp;= \frac{1}{\sqrt{r}}P_{nl}\left(r(x)\right)
\end{aligned}\]</p><p>After that, the radial Schrödinger equation is following.</p><p class="math-container">\[-\frac{1}{2\mu}\frac{\partial^{2}y_{nl}(x)}{\partial x^{2}}+\left(\frac{1}{2\mu}\left(l+\frac{1}{2}\right)^{2}+r^{2}V(r)\right)y_{nl}(x)=r^{2}E_{nl}y_{nl}(x)\]</p><p>in <a href="https://en.wikipedia.org/wiki/Hartree_atomic_units">Atomic units</a>,  as we use throughout, i.e. <span>$\hbar = 1$</span> and <span>$4\pi\epsilon_0 = 1$</span>.  It means that distances are in 1 a.u. = 0.529177 Angstrom and Coulomb  potential is</p><p class="math-container">\[V(r) = -\frac{Z}{\epsilon r}\]</p><h3 id="Pseudospectral-method"><a class="docs-heading-anchor" href="#Pseudospectral-method">Pseudospectral method</a><a id="Pseudospectral-method-1"></a><a class="docs-heading-anchor-permalink" href="#Pseudospectral-method" title="Permalink"></a></h3><p><a href="https://en.wikipedia.org/wiki/Collocation_method">Pseudospectral method</a> is convenient approach to code a solution of differential equation. The wavefunction is taken as a linear combination of basis <a href="https://en.wikipedia.org/wiki/Sinc_function">sinc-functions.</a></p><p class="math-container">\[\begin{aligned}
y(x) &amp;= \sum_{i=1}^{n}c_{i}\phi_{i}(x)\\
\phi_{i}(x) &amp;= \frac{\sin\left(\pi(x-x_{i})/h\right)}{\pi(x-x_{i})/h}
\end{aligned}\]</p><p>Discrete grid</p><p class="math-container">\[x_{i}=x_{min}+i\cdot h\]</p><p>where <span>$i=1\ldots n$</span> and step size <span>$h$</span>, defines basis set, since</p><p class="math-container">\[\phi_{i}(x_{j})=\left\{ \begin{array}{clr}
1 &amp; \text{for} &amp; i=j\\
0 &amp; \text{for} &amp; i\neq j
\end{array}\right.\]</p><p>coefficients are values of the function on a grid.</p><p class="math-container">\[c_i = y(x_i)\]</p><p>The first derivative of a basis function taken on a grid point is</p><p class="math-container">\[\phi&#39;_j(x_i)=\frac{1}{h}\frac{(-1)^i}{i}\]</p><p>Therefore, differentiation of a function on the grid <span>$x_i$</span> is equivalent to matrix-vector product</p><p class="math-container">\[\mathrm{y&#39;(x_i)} = \mathrm{D^{(1)}} \cdot \mathrm{y(x_i)}\]</p><p>where matrices for the first and second derivatives are</p><p class="math-container">\[\mathrm{D^{(1)}}=\frac{1}{h}\left(\begin{array}{ccccc}
0 &amp; 1 &amp; -\frac{1}{2} &amp; \cdots &amp; \frac{(-1)^{n}}{n-1}\\
-1 &amp; 0 &amp; 1\\
\frac{1}{2} &amp; -1 &amp; 0 &amp;  &amp; -\frac{1}{2}\\
 &amp;  &amp;  &amp; \ddots &amp; 1\\
\frac{(-1)^{n-1}}{n-1} &amp; \cdots &amp; \frac{1}{2} &amp; -1 &amp; 0
\end{array}\right)\]</p><p class="math-container">\[\mathrm{D^{(2)}}=\frac{1}{h^{2}}\left(\begin{array}{ccccc}
-\frac{\pi^{2}}{3} &amp; 2 &amp; -\frac{1}{2} &amp; \cdots &amp; \frac{2(-1)^{n}}{(n-1)^{2}}\\
2 &amp; -\frac{\pi^{2}}{3} &amp; 2\\
-\frac{1}{2} &amp; 2 &amp; -\frac{\pi^{2}}{3} &amp;  &amp; -\frac{1}{2}\\
 &amp;  &amp;  &amp; \ddots &amp; 2\\
\frac{2(-1)^{n}}{(n-1)^{2}} &amp; \cdots &amp; -\frac{1}{2} &amp; 2 &amp; -\frac{\pi^{2}}{3}
\end{array}\right)\]</p><p>With these matrices, a numerical solution of Schrödinger equation becomes a linear algebra problem. For this to be done, we have the following ingredients:</p><ol><li>logarithmic grid <span>$x_i = \ln(r_i)$</span> on which vectors are calculated: orbitals <span>$y_k$</span> and potential <span>$V(r)$</span>,</li><li>diagonal matrices: <span>$\mathrm{S} = r_i^2$</span> and <span>$\mathrm{V_{\text{eff}}}=\frac{1}{2\mu}\left(l+\frac{1}{2}\right)^{2}+r_i^{2}V(r_i)$</span>,  </li><li>kinetic energy operator <span>$\mathrm{K}=-\frac{1}{2\mu}\cdot D^{(2)}$</span>,</li><li>hamiltonian operator <span>$\mathrm{H = K + V_{\text{eff}}}$</span>.</li></ol><p>Variants of this approach can be found in the documentation <a href="http://appliedmaths.sun.ac.za/~weideman/research/differ.html">A Matlab Differentiation Matrix Suite.</a></p><h3 id="Peculiarities-of-the-eigenvalue-problem"><a class="docs-heading-anchor" href="#Peculiarities-of-the-eigenvalue-problem">Peculiarities of the eigenvalue problem</a><a id="Peculiarities-of-the-eigenvalue-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Peculiarities-of-the-eigenvalue-problem" title="Permalink"></a></h3><p>Solution of the <a href="https://en.wikipedia.org/wiki/Eigendecomposition_of_a_matrix">eigenvalues problem</a> is pairs of eigenvectors <span>$\epsilon_k$</span> and eigenvectors <span>$y_k$</span>, that correspond to the particle&#39;s energy levels and wavefunctions (orbitals). The <span>$i$</span> component of the <span>$y_k$</span> eigenvector is the value of the <span>$k$</span> level wavefunction at the <span>$x_i$</span> grid point. It is this property of the pseudospectral method that makes the algorithm compact and clear.</p><p class="math-container">\[\mathrm{H\cdot y = S\cdot y}\]</p><p>The <a href="https://en.wikipedia.org/wiki/Eigendecomposition_of_a_matrix#Generalized_eigenvalue_problem">generalized eigenvalue problem</a> of eigenvalues of a symmetrical matrix <span>$H$</span> and a symmetrical, positively defined matrix <span>$S$</span> can be reduced to the symmetrical eigenvalues problem using the <a href="https://doi.org/10.1016/S0065-3276(08)60339-1">symmetrical Löwdin orthogonalization.</a></p><p class="math-container">\[\mathrm{\underset{H&#39;}{\underbrace{S^{-\frac{1}{2}}\cdot H\cdot S^{-\frac{1}{2}}}}\cdot\underset{y&#39;}{\underbrace{S^{\frac{1}{2}}\cdot y}}=E\cdot\underset{y&#39;}{\underbrace{S^{\frac{1}{2}}\cdot y}}}\]</p><p>where</p><p class="math-container">\[\mathrm{H&#39;}=\left(\begin{array}{cccc}
\frac{H_{11}}{r_{1}r_{1}} &amp; \frac{H_{12}}{r_{1}r_{2}} &amp; \cdots &amp; \frac{H_{1n}}{r_{1}r_{n}}\\
\frac{H_{21}}{r_{2}r_{1}} &amp; \frac{H_{22}}{r_{2}^{2}} &amp;  &amp; \vdots\\
\vdots &amp;  &amp; \ddots\\
\frac{H_{n1}}{r_{n}r_{1}} &amp; \cdots &amp;  &amp; \frac{H_{nn}}{r_{n}^{2}}
\end{array}\right)\]</p><p>However, the floating point representation of numbers leads to symmetry loss of the matrix <span>$H&#39;$</span> due to non-associativity.</p><p class="math-container">\[H_{ij}/r_i/r_j \neq H_{ji}/r_j/r_i\]</p><p><a href="http://www.netlib.org/lapack/lug/node54.html">The standard algorithm implemented in the LAPACK library</a> for the generalized eigenvalue problem uses the <a href="https://en.wikipedia.org/wiki/Cholesky_decomposition">Cholesky decomposition</a>, but its scope <a href="http://www.netlib.org/utk/people/JackDongarra/etemplates/node177.html#sec:gsym_pert">is limited</a> to the case when <span>$\mathrm{S}$</span> matrix is well defined, i.e. condition number</p><p class="math-container">\[k(\mathrm{S})\equiv\left\Vert \mathrm{S}\right\Vert _{2}\cdot\left\Vert \mathrm{S}^{-1}\right\Vert _{2}\]</p><p>is not large. In our case, this number is very large, ca <span>$10^{52}$</span></p><p class="math-container">\[k(\mathrm{S})=\sqrt{\sum_{i}r_{i}^{2}}\cdot\sqrt{\sum_{i}\frac{1}{r_{i}^{2}}}&gt;\frac{r_{max}}{r_{min}}\]</p><p>To remedy the problem, note that eigenvalues of <a href="https://en.wikipedia.org/wiki/Matrix_pencil">matrix pencils</a> <span>$(\mathrm{H,S})$</span> and <span>$(\mathrm{H,\alpha S + \beta H})$</span> are same, when matrix <span>$\mathrm{\alpha S + \beta H}$</span> is positive definite. Then</p><p class="math-container">\[\mathrm{H \cdot y = \theta \cdot (\alpha S + \beta H) \cdot y}\]</p><p>has eigenvalues</p><p class="math-container">\[\theta_i = \frac{\epsilon_i}{\alpha + \beta \epsilon_i}\]</p><p>Setting <span>$\beta = 1$</span> and <span>$\alpha = 10^5$</span> we make new matrix</p><p class="math-container">\[\mathrm{S&#39; = \alpha S + H}\]</p><p>which is positive definite and well-conditioned, then solve the problem</p><p class="math-container">\[\mathrm{H \cdot y = \theta \cdot S&#39; \cdot y}\]</p><p>using standard LAPACK routine. Eigenvalues of interest are found with</p><p class="math-container">\[\epsilon_i = \frac{\alpha \cdot \theta_i}{1 - \theta_i}\]</p><p>This approach is used in the present code.</p><h3 id="Sketch-of-the-solution"><a class="docs-heading-anchor" href="#Sketch-of-the-solution">Sketch of the solution</a><a id="Sketch-of-the-solution-1"></a><a class="docs-heading-anchor-permalink" href="#Sketch-of-the-solution" title="Permalink"></a></h3><p>We are going to find a solution of the differential equation</p><p class="math-container">\[-\frac{1}{2\mu}\frac{\partial^{2}y_{nl}(x)}{\partial x^{2}}+\left(\frac{1}{2\mu}\left(l+\frac{1}{2}\right)^{2}+r^{2}V(r)\right)y_{nl}(x)=r^{2}E_{nl}y_{nl}(x)\]</p><p>on the grid <span>$x_i = x_{min} + (i-1)\cdot dx$</span>.</p><pre><code class="language-julia">using LinearAlgebra

# find differentiation matrix
function laplacian(x)
  n, h = length(x), step(x)
  Δ = Matrix{Float64}(undef, n, n)
  Δ[diagind(Δ, 0)] .= -1/3 * π^2 / h^2
  for i = 2:n
    Δ[diagind(Δ, i - 1)] =
    Δ[diagind(Δ, 1 - i)] .= 2 * (-1)^i / (i - 1)^2 / h^2
  end
  return Δ
end

# make logarithmic grid on r
x = -30.0:0.175:5.0; r = exp.(x); r² = exp.(2x)

# set up parameters of the hydrogen atom hamiltonian:
# reduced mass, azimuthal quantum number, and nucleus charge
μ = 1; l = 0; Z = 1;

# make hamiltonian matrix
H = -1/2μ*laplacian(x) + Diagonal(1/2μ * (l + 1/2)^2 .- Z*r);

# form positive definite well-conditioned matrix S
α = 1e5; β = 1;
S = β*H + α * Diagonal(r .* r);

# solve generalized eigenproblem
θ, y = eigen(H, S);
ϵ = α * θ ./ (1.0 .- θ);

# see energy of the 1s-state of hydrogen atom
ϵ[1]</code></pre><pre class="documenter-example-output">-0.5000000000511893</pre><h2 id="Functions-for-solving-Schrödinger-equation"><a class="docs-heading-anchor" href="#Functions-for-solving-Schrödinger-equation">Functions for solving Schrödinger equation</a><a id="Functions-for-solving-Schrödinger-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Functions-for-solving-Schrödinger-equation" title="Permalink"></a></h2><h3 id="Differentiation-matrix"><a class="docs-heading-anchor" href="#Differentiation-matrix">Differentiation matrix</a><a id="Differentiation-matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Differentiation-matrix" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="AtomEnergyLevels.laplacian" href="#AtomEnergyLevels.laplacian"><code>AtomEnergyLevels.laplacian</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">laplacian(n::Int, h::Real)
laplacian(x::AbstractRange{T}) where {T}</code></pre><p>Returns <span>$n \times n$</span> differentiation matrix <span>$\mathrm{D^{(2)}}$</span> using sinc interpolants.  See Weideman, J.A., and Reddy, S.C. (2000). A MATLAB differentiation matrix suite.  ACM Transactions on Mathematical Software (TOMS), 26(4), 465-519. Equation (20) on page 485.</p><p>On input: <code>n</code> - size of a uniform grid with step size <code>h</code>, or <code>x</code> - <code>AbstractRange</code> object.</p><p><strong>Example</strong></p><p>Second derivative of the gaussian function</p><p class="math-container">\[    \partial^2 \exp(-x^2)/\partial x^2 = 2(2x^2 - 1)\exp(-x^2)\]</p><pre><code class="language-julia-repl">julia&gt; x = -6:0.01:6
-6.0:0.01:6.0

julia&gt; d²f_exact = 2(2x.^2 .- 1).*exp.(-x.^2);

julia&gt; d²f_approx = laplacian(length(x), step(x)) * exp.(-x.^2);

julia&gt; isapprox(d²f_exact, d²f_approx, atol = 1e-10)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/malykhin-sergei/AtomEnergyLevels.jl/blob/d9f09df34eaa2a226b29d2895199df97618166cd/src/sincdif.jl#L1-L28">source</a></section></article><p>Using the following code, one can find the vibrational levels of the radical OH⋅, for which the potential energy surface is approximated through the <a href="https://en.wikipedia.org/wiki/Morse_potential">Morse potential</a>.</p><pre><code class="language-julia">using AtomEnergyLevels
using LinearAlgebra, Test, Printf

# Morse potential
V(x, D, β, x₀) = D*(exp(-β*(x-x₀))-1)^2 - D;

# parameters of the O-H bond
D  = 0.1994;   β = 1.189;  x₀ = 1.821;
mH = 1.00794; mO = 15.9994; μ = 1822.8885*(mH*mO)/(mH+mO);

# grid
x = (2.0 - x₀):0.1:(12.0 + x₀);

# hamiltonian
H = -1/2μ*laplacian(x) + Diagonal(V.(x, D, β, x₀));

# numerical solution
ϵ, ψ = eigen(H);

# exact solution
ω = β*sqrt(2D/μ); δ = ω^2 / 4D;
E(n) = ω*(n+1/2) - δ*(n+1/2)^2 - D;

# comparison
for i in 1:5
  @printf &quot;Level %i: E(exact) = %5.10f E(approx) = %5.10f\n&quot; i E(i-1) ϵ[i]
end</code></pre><pre class="documenter-example-output">Level 1: E(exact) = -0.1904720166 E(approx) = -0.1904720166
Level 2: E(exact) = -0.1732294768 E(approx) = -0.1732294768
Level 3: E(exact) = -0.1568048397 E(approx) = -0.1568048397
Level 4: E(exact) = -0.1411981052 E(approx) = -0.1411981048
Level 5: E(exact) = -0.1264092734 E(approx) = -0.1264092731</pre><h3 id="Atomic-electron-configuration-parsing"><a class="docs-heading-anchor" href="#Atomic-electron-configuration-parsing">Atomic electron configuration parsing</a><a id="Atomic-electron-configuration-parsing-1"></a><a class="docs-heading-anchor-permalink" href="#Atomic-electron-configuration-parsing" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="AtomEnergyLevels.conf_enc" href="#AtomEnergyLevels.conf_enc"><code>AtomEnergyLevels.conf_enc</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">conf_enc(input::AbstractString; maxn = 7, spins = 2,
notation = Dict(&quot;s&quot; =&gt; 0, &quot;p&quot; =&gt; 1, &quot;d&quot; =&gt; 2, &quot;f&quot; =&gt; 3))</code></pre><p>Parse an input string as the configuration of an atom. An electronic  configuration is string like &quot;[He] 2s2 2p1&quot;, where the notation [X] indicates  that all subshells associated with the noble gas X are fully occupied.  The function encodes the configuration provided &quot;[He] 2s2 2p1&quot; and returns  <code>((2.0, 2.0), (1.0,))</code>, where subtuples <code>(2.0, 2.0)</code> and <code>(1.0,)</code> are  populations of all the l = 0 and l = 1 shells, i.e. <code>((1s², 2s²), (2p¹,))</code>.  Within each subtuple populations of levels with the same azimuthal quantum  number l and subsequent radial quantum numbers nᵣ are listed.</p><p>Optional keyword arguments are:</p><ul><li><code>maxn</code>  - maximal permitted principal quantum number</li><li><code>spins</code> - number of spin up/spin down electrons per level (1 or 2)</li><li><code>notation</code> - dictionary encoding the correspondence of quantum numbers l = 0, 1... to letters: s, p, d... See <a href="https://en.wikipedia.org/wiki/Spectroscopic_notation">spectroscopic notation</a></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; conf = conf_enc(&quot;[Ar] 3d1 4s2&quot;) # Scandium, Z = 21
((2.0, 2.0, 2.0, 2.0), (6.0, 6.0), (1.0,))

julia&gt; sum(collect(Iterators.flatten(conf)))
21.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/malykhin-sergei/AtomEnergyLevels.jl/blob/d9f09df34eaa2a226b29d2895199df97618166cd/src/conf_parse.jl#L1-L28">source</a></section></article><h3 id="Radial-Schrödinger-equation-solver"><a class="docs-heading-anchor" href="#Radial-Schrödinger-equation-solver">Radial Schrödinger equation solver</a><a id="Radial-Schrödinger-equation-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Radial-Schrödinger-equation-solver" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="AtomEnergyLevels.radial_shr_eq" href="#AtomEnergyLevels.radial_shr_eq"><code>AtomEnergyLevels.radial_shr_eq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">radial_shr_eq(V::Function = r -&gt; -1/r, x::AbstractRange{T} = -30.0:0.1:5.0;
conf = 1, μ = 1.0, α = 1e5) where {T}

radial_shr_eq(V::Array{S}, x::AbstractRange{T}; 
conf = 1, μ = 1.0, α = 1e5) where {S, T}</code></pre><p>Solve Schrödinger equation (<a href="https://en.wikipedia.org/wiki/Hartree_atomic_units">atomic units</a> are assumed)</p><p class="math-container">\[-\frac{1}{2\mu}\left[\frac{1}{r^{2}}\frac{\partial}{\partial r}\left(r^{2}\frac{\partial R_{nl}}{\partial r}\right)-\frac{l(l+1)}{r^{2}}R_{nl}(r)\right]+V(r)R_{nl}(r)=E_{nl}R_{nl}(r)\]</p><p>for <a href="https://en.wikipedia.org/wiki/Particle_in_a_spherically_symmetric_potential">the particle in a spherically symmetric potential.</a></p><p><strong>On input:</strong></p><ul><li><code>V</code> - potential, provided as an explicit function <span>$V(r)$</span> (by default <code>r -&gt; -1/r</code>), or an array of values on a radial grid.</li><li><code>x</code> - uniform grid (<code>AbstractRange</code> object), such as <span>$r_i = \exp(x_i)$</span>. Default grid is <code>-30.0:0.1:5.0</code></li><li><code>conf</code> - electronic configuration of interest, by default: ground state <code>conf = ((1.0),)</code></li><li><code>μ</code> - <a href="https://en.wikipedia.org/wiki/Reduced_mass">reduced mass</a>, by default <code>μ = 1.0</code> (electron mass in a.u.)</li><li><code>α</code> - parameter <span>$α = 10^5$</span> is used in the matrix pencil <span>$\mathrm{H} + α\mathrm{S}$</span> for the generalized eigenproblem.</li></ul><p><strong>On output function returns:</strong></p><ul><li>sum of one-particle energies: <span>$E = \sum_{i=1}^{N} n_i \epsilon_i$</span></li><li>particles density: <span>$\rho(x) = \frac{1}{4\pi} \sum_{i=1}^{N} n_i y_{i}^{2}(x)$</span></li><li>orbitals <span>$y_i(x)$</span>, corresponding eigenvalues <span>$\epsilon_i$</span> (energy levels), azimuthal and radial quantum numbers <span>$l$</span>, <span>$n_r$</span>, and level populations <span>$n_i$</span> (as listed in <code>conf</code>).</li></ul><p><strong>Examples</strong></p><p><a href="https://en.wikipedia.org/wiki/Hydrogen_atom">Hydrogen atom</a></p><pre><code class="language-julia-repl">julia&gt; radial_shr_eq(r -&gt; -1/r, conf = conf_enc(&quot;1s1&quot;)).energy ≈ -1/2
true

julia&gt; radial_shr_eq(r -&gt; -1/r, conf = conf_enc(&quot;2s1&quot;)).energy ≈ -1/8
true

julia&gt; radial_shr_eq(r -&gt; -1/r, conf = conf_enc(&quot;2p1&quot;)).energy ≈ -1/8
true

julia&gt; radial_shr_eq(r -&gt; -1/r, conf = conf_enc(&quot;3s1&quot;)).energy ≈ -1/18
true

julia&gt; radial_shr_eq(r -&gt; -1/r, conf = conf_enc(&quot;3p1&quot;)).energy ≈ -1/18
true

julia&gt; radial_shr_eq(r -&gt; -1/r, conf = conf_enc(&quot;3d1&quot;)).energy ≈ -1/18
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/malykhin-sergei/AtomEnergyLevels.jl/blob/d9f09df34eaa2a226b29d2895199df97618166cd/src/rshreq.jl#L1-L50">source</a></section></article><h4 id="Isotropic-harmonic-oscillator"><a class="docs-heading-anchor" href="#Isotropic-harmonic-oscillator">Isotropic harmonic oscillator</a><a id="Isotropic-harmonic-oscillator-1"></a><a class="docs-heading-anchor-permalink" href="#Isotropic-harmonic-oscillator" title="Permalink"></a></h4><p>Using the following code, one can find the energy levels for a <a href="https://en.wikipedia.org/wiki/Quantum_harmonic_oscillator#Example:_3D_isotropic_harmonic_oscillator">spherically-symmetric three-dimensional harmonic oscillator.</a></p><p>To find the energy levels with quantum numbers nᵣ = 0, 1, 2 and l = 0, 1, 2 the levels of interest should be included in the electronic configuration.</p><pre><code class="language-julia">using AtomEnergyLevels, Printf

function isotropic_harmonic_oscillator(cfg)
  ψ = radial_shr_eq(r -&gt; 1/2*r^2, conf = conf_enc(cfg)).orbitals;
  @printf(&quot;\tϵ(calc.)\tϵ(exact)\tΔϵ\n&quot;);
  for (quantum_numbers, orbital) in sort(collect(ψ), by = x -&gt; last(x).ϵᵢ)
    nᵣ, l = quantum_numbers
    ϵ_calc = orbital.ϵᵢ
    n = nᵣ + l + 1
    ϵ_exact = 2nᵣ + l + 3/2
    @printf(&quot;%i%s\t%10.8f\t%10.8f\t%+0.6e\n&quot;,
            n, atomic_shell[l], ϵ_calc, ϵ_exact, ϵ_exact - ϵ_calc)
  end
end

isotropic_harmonic_oscillator(&quot;1s1 2s1 3s1 2p1 3p1 4p1 3d1 4d1 5d1&quot;);</code></pre><pre class="documenter-example-output">	ϵ(calc.)	ϵ(exact)	Δϵ
1S	1.50000000	1.50000000	-2.639289e-11
2P	2.50000000	2.50000000	+3.940093e-11
3D	3.50000000	3.50000000	+2.014788e-11
2S	3.50000000	3.50000000	-2.537082e-12
3P	4.50000000	4.50000000	+3.407141e-11
4D	5.50000000	5.50000000	+3.625988e-11
3S	5.50000000	5.50000000	+4.071410e-12
4P	6.50000000	6.50000000	+2.108536e-12
5D	7.50000000	7.50000000	+4.278622e-11</pre><h4 id="Kratzer-Potential"><a class="docs-heading-anchor" href="#Kratzer-Potential">Kratzer Potential</a><a id="Kratzer-Potential-1"></a><a class="docs-heading-anchor-permalink" href="#Kratzer-Potential" title="Permalink"></a></h4><pre><code class="language-julia">using AtomEnergyLevels, Printf

&quot;&quot;&quot;
Solutions of the Schrödinger Equation for the Kratzer Potential.
A. Kratzer, &quot;Die ultraroten Rotationsspektren der Halogenwasserstoffe,&quot;
Zeitschrift für Physik, 3(5), 1920 pp. 289–307. doi:10.1007/BF01327754

See also
https://demonstrations.wolfram.com/ExactSolutionsOfTheSchroedingerEquationForTheKratzerPotentia/
&quot;&quot;&quot;
function kratzer(D, a, levels::Union{UnitRange{Int64}, Int64} = 0)
    cfg = join(collect(levels) .+ 1, &quot;s1 &quot;) * &quot;s1&quot;
    ψ = radial_shr_eq(r -&gt; -2D*(a/r - a^2 / 2r^2),
        conf = conf_enc(cfg, maxn = last(levels) + 1)).orbitals

    μ = 1/2*sqrt(1 + 8a^2*D)

    @printf(&quot;\tϵ(calc.)\tϵ(exact)\tΔϵ\n&quot;);
    for (quantum_numbers, orbital) in sort(collect(ψ), by = x -&gt; last(x).ϵᵢ)
      nᵣ, l = quantum_numbers
      ϵ_calc = orbital.ϵᵢ
      n = nᵣ + l + 1
      ϵ_exact = -2a^2 * D^2 / (nᵣ + μ + 1/2)^2
      @printf(&quot;%i%s\t%11.8f\t%11.8f\t%+0.6e\n&quot;,
              n, atomic_shell[l], ϵ_calc, ϵ_exact, ϵ_exact - ϵ_calc)
    end
end

kratzer(2.5, 1.25, 0:10)</code></pre><pre class="documenter-example-output">	ϵ(calc.)	ϵ(exact)	Δϵ
1S	-1.75137466	-1.75137466	-2.856160e-12
2S	-1.03719360	-1.03719360	-2.680545e-11
3S	-0.68507215	-0.68507215	-3.032552e-11
4S	-0.48598885	-0.48598885	-6.545192e-11
5S	-0.36257889	-0.36257889	+2.029810e-11
6S	-0.28083730	-0.28083730	-1.992945e-11
7S	-0.22391699	-0.22391699	+4.770345e-11
8S	-0.18269843	-0.18269843	-4.564746e-11
9S	-0.15189579	-0.15189579	+1.754102e-11
10S	-0.12827385	-0.12827385	-4.671158e-11
11S	-0.10976248	-0.10976248	-6.844827e-11</pre><h4 id="Pseudoharmonic-Potential"><a class="docs-heading-anchor" href="#Pseudoharmonic-Potential">Pseudoharmonic Potential</a><a id="Pseudoharmonic-Potential-1"></a><a class="docs-heading-anchor-permalink" href="#Pseudoharmonic-Potential" title="Permalink"></a></h4><pre><code class="language-julia">using AtomEnergyLevels, Printf

&quot;&quot;&quot;
Solutions of the Schrödinger Equation for Pseudoharmonic Potential.

I.I. Gol&#39;dman and V.D. Krivchenkov, Problems in Quantum Mechanics
(B. T. Geǐlikman, ed., E. Marquit and E. Lepa, trans.), Reading, MA: Addison-Wesley, 1961.‬

See also
https://demonstrations.wolfram.com/ExactSolutionsOfTheSchroedingerEquationForPseudoharmonicPote/
&quot;&quot;&quot;
function pseudoharmonic(D, a, levels::Union{UnitRange{Int64}, Int64} = 0)
    cfg = join(collect(levels) .+ 1, &quot;s1 &quot;) * &quot;s1&quot;
    ψ = radial_shr_eq(r -&gt; D*(r/a - a/r)^2, -5.0:0.01:4.0,
        conf = conf_enc(cfg, maxn = last(levels) + 1)).orbitals

    @printf(&quot;\tϵ(calc.)\tϵ(exact)\tΔϵ\n&quot;);
    for (quantum_numbers, orbital) in sort(collect(ψ), by = x -&gt; last(x).ϵᵢ)
      nᵣ, l = quantum_numbers
      ϵ_calc = orbital.ϵᵢ
      n = nᵣ + l + 1
      ϵ_exact = sqrt(D/2)/a * (2 + 4nᵣ - 2a * sqrt(2D) + sqrt(1 + 8D * a^2))
      @printf(&quot;%i%s\t%11.8f\t%11.8f\t%+0.6e\n&quot;,
              n, atomic_shell[l], ϵ_calc, ϵ_exact, ϵ_exact - ϵ_calc)
    end
end

pseudoharmonic(1, 2, 0:10)</code></pre><pre class="documenter-example-output">	ϵ(calc.)	ϵ(exact)	Δϵ
1S	 0.73811638	 0.73811638	+1.793787e-12
2S	 2.15232994	 2.15232994	+2.203127e-12
3S	 3.56654351	 3.56654351	-1.026290e-12
4S	 4.98075707	 4.98075707	-1.415756e-12
5S	 6.39497063	 6.39497063	-7.286616e-12
6S	 7.80918419	 7.80918419	-2.055245e-12
7S	 9.22339776	 9.22339776	-6.917134e-12
8S	10.63761132	10.63761132	-5.657697e-12
9S	12.05182488	12.05182488	-1.716494e-11
10S	13.46603844	13.46603844	-1.173284e-11
11S	14.88025201	14.88025201	-1.815970e-11</pre><h2 id="Kohn-Sham-equations"><a class="docs-heading-anchor" href="#Kohn-Sham-equations">Kohn-Sham equations</a><a id="Kohn-Sham-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Kohn-Sham-equations" title="Permalink"></a></h2><p>The <a href="https://en.wikipedia.org/wiki/Kohn%E2%80%93Sham_equations">Kohn–Sham equations</a>  consist of the radial Schrödinger equation above with an with an effective  potential <span>$V(r)$</span> given by</p><p class="math-container">\[V = v_H + v_{xc} + v_{ext}\]</p><p>where <span>$v_H$</span> is the <a href="https://en.wikipedia.org/wiki/Hartree_equation">Hartree potential</a>  given by the solution of the radial <a href="https://en.wikipedia.org/wiki/Poisson%27s_equation">Poisson equation</a>, <span>$v_{xc}$</span> is the exchange-correlation potential and <span>$v_{ext}$</span> is the external potential (most offen electron-nuclear <span>$v_{ext} = -Z/r$</span> interaction).</p><h3 id="Poisson-equation-and-the-Hartree-potential"><a class="docs-heading-anchor" href="#Poisson-equation-and-the-Hartree-potential">Poisson equation and the Hartree potential</a><a id="Poisson-equation-and-the-Hartree-potential-1"></a><a class="docs-heading-anchor-permalink" href="#Poisson-equation-and-the-Hartree-potential" title="Permalink"></a></h3><p>https://arxiv.org/pdf/1209.1752v2.pdf https://github.com/aromanro/DFTAtom</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 6 December 2020 19:26">Sunday 6 December 2020</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
