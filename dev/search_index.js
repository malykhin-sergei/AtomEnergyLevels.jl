var documenterSearchIndex = {"docs":
[{"location":"#AtomEnergyLevels.jl","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"","category":"section"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"Solve numerically","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"1D Schrödinger equation by the spectral collocation (i.e., pseudospectral) method\nSchrödinger equation for the particle in a spherically symmetric potential\nKohn-Sham equation for an atom using local-density approximation (LDA)","category":"page"},{"location":"#Theory","page":"AtomEnergyLevels.jl","title":"Theory","text":"","category":"section"},{"location":"#Change-of-variables","page":"AtomEnergyLevels.jl","title":"Change of variables","text":"","category":"section"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"The dynamics of a particle in a spherically symmetric potential are governed  by a Hamiltonian of the following form:","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"-frachbar^22muundersetDelta R_nlunderbraceleftfrac1r^2fracpartialpartial rleft(r^2fracpartial R_nlpartial rright)-fracl(l+1)r^2R_nl(r)right+V(r)R_nl(r)=E_nlR_nl(r)","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"where Delta - Laplace operator, r - distance between the particle and a defined center point (nucleus), mu - reduced mass, R_nl(r) - radial part of a wavefunction,  E_nl - eigenstate of a system (energy level). The eigenfunctions take the form","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"psi(rthetaphi)=R_nl(r)cdot Y_lm(thetaphi)","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"where Y_lm(thetaphi) - spherical harmonic.","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"The substitution","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"R_nl(r)=frac1rP_nl(r)","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"results in Schrödinger equation of the form:","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"-frachbar^22mleftfracpartial^2P_nlpartial r^2-fracl(l+1)r^2P_nl(r)right+V(r)P_nl(r)=E_nlP_nl(r)","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"To solve the latter equation the variable r and eigenfunction P_nl(r) are changed to x and y_nl(x), where","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"beginaligned\nr = e^x\ny_nl(x) = frac1sqrtrP_nlleft(r(x)right)\nendaligned","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"After that, radial Schrödinger equation takes convenient form for numerical solution.","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"-frac12mufracpartial^2y_nl(x)partial x^2+left(frac12muleft(l+frac12right)^2+r^2V(r)right)y_nl(x)=r^2E_nly_nl(x)","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"Atomic units are used  throughout, i.e. hbar = 1 and 4piepsilon_0 = 1. It means that distances are in 1au = 0529177AA and coulomb potential is","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"V(r) = -fracZepsilon r","category":"page"},{"location":"#Pseudospectral-method","page":"AtomEnergyLevels.jl","title":"Pseudospectral method","text":"","category":"section"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"Pseudospectral method is convenient approach to code a solution of differential equation. The wavefunction is taken as a linear combination of sinc-functions.","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"beginaligned\ny(x) = sum_i=1^nc_iphi_i(x)\nphi_i(x) = fracsinleft(pi(x-x_i)hright)pi(x-x_i)h\nendaligned","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"Discrete grid","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"x_i=x_min+icdot h","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"where i=1ldots n and step size h, defines basis set, since","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"phi_i(x_j)=left beginarrayclr\n1  textfor  i=j\n0  textfor  ineq j\nendarrayright","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"Coefficients are values of the function on a grid.","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"c_i = y(x_i)","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"The first derivative of a basis function taken on a grid point is","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"phi_j(x_i)=frac1hfrac(-1)^ii","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"Therefore, differentiation of a function on the grid x_i is equivalent to matrix-vector product","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"mathrmy(x_i) = mathrmD^(1) cdot mathrmy(x_i)","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"where matrices for the first and second derivatives are","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"mathrmD^(1)=frac1hleft(beginarrayccccc\n0  1  -frac12  cdots  frac(-1)^nn-1\n-1  0  1\nfrac12  -1  0    -frac12\n      ddots  1\nfrac(-1)^n-1n-1  cdots  frac12  -1  0\nendarrayright)","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"mathrmD^(2)=frac1h^2left(beginarrayccccc\n-fracpi^23  2  -frac12  cdots  frac2(-1)^n(n-1)^2\n2  -fracpi^23  2\n-frac12  2  -fracpi^23    -frac12\n      ddots  2\nfrac2(-1)^n(n-1)^2  cdots  -frac12  2  -fracpi^23\nendarrayright)","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"With these matrices, the numerical solution of Schrödinger equation becomes  a linear algebra problem. For this we have the following ingredients:","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"logarithmic grid r_i=exp(x_i) on which vectors are calculated: orbitals y_k and potential V(r),\ndiagonal matrices: mathrmS = r_i^2 and mathrmV_texteff=frac12muleft(l+frac12right)^2+r_i^2V(r_i),  \nkinetic energy operator mathrmK=-frac12mucdot D^(2),\nHamiltonian operator mathrmH = K + V_texteff.","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"Variants of this approach can be found in the documentation  A Matlab Differentiation Matrix Suite.","category":"page"},{"location":"#Peculiarities-of-the-eigenvalue-problem","page":"AtomEnergyLevels.jl","title":"Peculiarities of the eigenvalue problem","text":"","category":"section"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"Solution of the eigenvalues problem  is pairs of eigenvectors epsilon_k and eigenvectors y_k,  that correspond to the particle's energy levels and wavefunctions (orbitals).  The i component of the y_k eigenvector is the value of the k level  wavefunction at the x_i grid point. It is this property of the  pseudospectral method that makes the algorithm compact and clear.","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"mathrmHcdot y = Scdot y","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"The generalized eigenvalue problem of eigenvalues of a symmetrical matrix H and a symmetrical,  positively defined matrix S is reduced to the symmetrical eigenvalues  problem using the symmetrical Lövdin orthogonalization.","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"mathrmundersetHunderbraceS^-frac12cdot Hcdot S^-frac12cdotundersetyunderbraceS^frac12cdot y=EcdotundersetyunderbraceS^frac12cdot y","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"where ","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"mathrmH=left(beginarraycccc\nfracH_11r_1r_1  fracH_12r_1r_2  cdots  fracH_1nr_1r_n\nfracH_21r_2r_1  fracH_22r_2^2    vdots\nvdots    ddots\nfracH_n1r_nr_1  cdots    fracH_nnr_n^2\nendarrayright)","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"However, the floating point representation of numbers leads to a loss of  symmetry of the matrix H due to non-associativity.","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"H_ijr_ir_j neq H_jir_jr_i","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"The standard algorithm implemented in the LAPACK library  for the generalized eigenvalue problem uses the Cholesky decomposition,  but its scope is limited  to the case when the mathrmS matrix is well defined, i.e.  condition number","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"k(mathrmS)equivleftVert mathrmSrightVert _2cdotleftVert mathrmS^-1rightVert _2","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"is not large. In our case, this number is very large, ca 10^52","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"k(mathrmS)=sqrtsum_ir_i^2cdotsqrtsum_ifrac1r_i^2fracr_maxr_min","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"To remedy the problem, note that eigenvalues of matrix pencils (mathrmHS) and (mathrmHalpha S + beta H) are same, when matrix mathrmalpha S + beta H is positive definite. Then","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"mathrmH cdot y = theta cdot (alpha S + beta H) cdot y","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"has eigenvalues","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"theta_i = fracepsilon_ialpha + beta epsilon_i","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"Setting beta = 1 and alpha = 10^5 we make new matrix","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"mathrmS = alpha S + H","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"which is positive definite and well-conditioned, then solve","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"mathrmH cdot y = theta cdot S cdot y","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"using standard LAPACK routine. Eigenvalues of interest are found with","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"epsilon_i = fracalpha cdot theta_i1 - theta_i","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"This approach is used here.","category":"page"},{"location":"#Sketch-of-the-solution","page":"AtomEnergyLevels.jl","title":"Sketch of the solution","text":"","category":"section"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"We are going to find a solution of the differential equation","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"-frac12mufracpartial^2y_nl(x)partial x^2+left(frac12muleft(l+frac12right)^2+r^2V(r)right)y_nl(x)=r^2E_nly_nl(x)","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"on the grid x_i = x_min + (i-1)cdot dx. ","category":"page"},{"location":"","page":"AtomEnergyLevels.jl","title":"AtomEnergyLevels.jl","text":"using LinearAlgebra\n\n# find differentiation matrix\nfunction laplacian(x)\n  n, h = length(x), step(x)\n  Δ = Matrix{Float64}(undef, n, n)\n  Δ[diagind(Δ, 0)] .= -1/3 * π^2 / h^2\n  for i = 2:n\n    Δ[diagind(Δ, i - 1)] = \n    Δ[diagind(Δ, 1 - i)] .= 2 * (-1)^i / (i - 1)^2 / h^2\n  end\n  return Δ\nend\n\n# make logarithmic grid on r\nx = -30.0:0.175:5.0; r = exp.(x); r² = exp.(2x)\n\n# set up parameters of the hydrogen atom hamiltonian:\n# reduced mass, azimuthal quantum number, and nucleus charge\nμ = 1; l = 0; Z = 1;\n\n# make hamiltonian matrix\nH = -1/2μ*laplacian(x) + Diagonal(1/2μ * (l + 1/2)^2 .- Z*r);\n\n# form positive definite well-conditioned matrix S\nα = 1e5; β = 1;\nS = β*H + α * Diagonal(r .* r);\n\n# solve generalized eigenproblem\nθ, y = eigen(H, S);\nϵ = α * θ ./ (1.0 .- θ);\n\n# see energy of the 1s-state of hydrogen atom\nϵ[1]","category":"page"}]
}
